# Auto-activate Poetry virtual environment
if command -v poetry >/dev/null 2>&1; then
    # Check if we're in a Poetry project
    if [ -f "pyproject.toml" ]; then
        # Get the Poetry virtual environment path
        POETRY_VENV=$(poetry env info --path 2>/dev/null)
        if [ -n "$POETRY_VENV" ] && [ -d "$POETRY_VENV" ]; then
            # Activate the virtual environment
            source "$POETRY_VENV/bin/activate"
            echo "🐍 Poetry virtual environment activated: $(basename "$POETRY_VENV")"
        fi
    fi
fi

# Set project-specific environment variables
export DBT_PROFILES_DIR="$(pwd)/dbt_models"
export PYTHONPATH="$(pwd):$PYTHONPATH"

# Add Poetry to PATH if not already there
export PATH="$(pwd)/.venv/bin:$PATH"

# Show helpful info
echo "🚀 Repository: generate-ads-data"
echo "📁 DBT profiles directory: $DBT_PROFILES_DIR"
echo "🐍 Python: $(which python)"
echo "📦 Poetry: $(which poetry)"
